webpackJsonp([7],{"24PT":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("Dd8w"),i=e.n(a),r=e("NYxO"),n=e("qwAB"),o=e("y/jF"),c=e("UgCr"),l={name:"product-list",data:function(){return{sortBtns:["综合","价格升序","价格降序"],sortIndex:0,list:[],hasMore:!0,getParams:{keyword:"",orderBy:"default",pageNum:1,pageSize:10}}},created:function(){var t=this;this.pullup=!0,setTimeout(function(){t.getParams.keyword=t.keyword,t._getProductlist(t.getParams)},20)},computed:i()({upScrollTips:function(){return this.hasMore?"正在加载...":"没有更多了"},placeText:function(){var t=["手机","键盘","电脑","护肤品","冰箱","玩具"];return t[Math.floor(Math.random()*t.length)]}},Object(r.c)(["keyword"])),methods:i()({selectItem:function(t){this.$router.push({path:"/product-list/"+t})},productSort:function(t){if(this.sortIndex=t,0===t){if("default"===this.getParams.orderBy)return;this.getParams.orderBy=""}else 1===t?this.getParams.orderBy="price_asc":2===t&&(this.getParams.orderBy="price_desc");this.handleKeyupEnter()},scrollEnd:function(){var t=this;setTimeout(function(){t._getProductlist()},20)},handleKeyupEnter:function(){this.hasMore=!0,this.getParams.keyword=this.$refs.input.value,this.getParams.pageNum=1,this.list=[],this.setKeyword(this.$refs.input.value),this.addHistory(this.$refs.input.value),this._getProductlist(this.getParams)},back:function(){this.$router.back(),this.$destroy()},_getProductlist:function(){var t=this;this.hasMore&&this.getParams.keyword&&Object(c.b)(this.getParams).then(function(s){t.getParams.pageNum++,t.list=t.list.concat(t._normalizeList(s.data.list)),setTimeout(function(){t.$refs.scroll.refresh()},20),t.hasMore=s.data.hasNextPage}).catch(function(s){t.$notice(s.msg)})},_normalizeList:function(t){var s=[];return t.forEach(function(t){null===t.mainImage&&(t.mainImage="3bc21ebe-445b-455b-a868-d8d480bea37a.jpg"),s.push(t)}),s}},Object(r.d)({setKeyword:"SET_KEYWORD"}),Object(r.b)(["addHistory"])),components:{Scroll:n.a,Loading:o.a}},u={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"product-list-wrap"},[e("div",{staticClass:"search-wrap"},[e("div",{staticClass:"back",on:{click:t.back}},[e("i",{staticClass:"iconfont"},[t._v("")])]),t._v(" "),e("div",{staticClass:"search-input"},[e("i",{staticClass:"iconfont icon-search"},[t._v("")]),t._v(" "),e("input",{ref:"input",staticClass:"input",attrs:{type:"text",placeholder:"请输入商品名字"},domProps:{value:t.keyword||t.placeText},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.handleKeyupEnter(s)}}})])]),t._v(" "),e("ul",{staticClass:"sort-rank"},t._l(t.sortBtns,function(s,a){return e("li",{key:s,staticClass:"sort-item",class:{active:a===t.sortIndex},on:{click:function(s){return t.productSort(a)}}},[t._v("\n      "+t._s(s)+"\n    ")])}),0),t._v(" "),e("scroll",{ref:"scroll",staticClass:"product-wrap",attrs:{pullup:t.pullup},on:{scrollEnd:t.scrollEnd}},[e("ul",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"product-list"},[t._l(t.list,function(s,a){return e("li",{key:a,staticClass:"product-item",on:{click:function(e){return t.selectItem(s.id)}}},[e("div",{staticClass:"product-img-show"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.imageHost+s.mainImage,expression:"item.imageHost + item.mainImage"}],staticClass:"img",attrs:{alt:""}})]),t._v(" "),e("div",{staticClass:"product-desc"},[e("span",{staticClass:"name"},[e("span",{staticClass:"tips"},[t._v(t._s(Math.random()>.6?"海外":Math.random()>.8?"代购":"自营"))]),t._v("\n            "+t._s(s.name.length>22?s.name.slice(0,22)+"...":s.name)+"\n          ")]),t._v(" "),e("span",{staticClass:"subname"},[t._v(t._s(s.subtitle.length>30?s.subtitle.slice(0,30)+"...":s.subtitle))]),t._v(" "),e("span",{staticClass:"price"},[e("span",{staticClass:"money"},[t._v("￥:")]),t._v("\n            "+t._s(s.price)+"\n          ")])])])}),t._v(" "),e("li",{staticClass:"product-last-tips"},[t._v(t._s(t.upScrollTips))])],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.list.length&&!t.hasMore,expression:"!list.length && !hasMore"}],staticClass:"no-goods"},[t._v("\n      抱歉没有找到您需要的商品。\n    ")]),t._v(" "),e("div",{staticClass:"loading-wrap"},[e("loading",{directives:[{name:"show",rawName:"v-show",value:!t.list.length&&t.hasMore,expression:"!list.length && hasMore"}]})],1)]),t._v(" "),e("router-view")],1)},staticRenderFns:[]};var d=e("VU/8")(l,u,!1,function(t){e("S0uE")},"data-v-715aa94a",null);s.default=d.exports},S0uE:function(t,s){},UgCr:function(t,s,e){"use strict";s.b=function(t){return Object(a.a)({url:"/product/list.do",params:t})},s.a=function(t){return Object(a.a)({url:"/product/detail.do",params:{productId:t}})};var a=e("him/")}});
//# sourceMappingURL=7.d37110fd5c993304ebbb.js.map